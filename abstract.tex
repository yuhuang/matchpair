Asynchronous message passing paradigm is commonly used in high performance computing (HPC).
Message non-determinism makes the error detection in message passing programs very difficult. The prior work uses an over-approximation of the precise match pair records (each is a pair of a send and a receive that may potentially match in the runtime) to capture all possible message communication in a concurrent trace program (CTP). The SMT encoding with such a set of match pairs is able to witness program properties including deadlock, message race, and zero-buffer compatibility, however, is inefficient because of the exponential ways of match pair resolution.
This paper presents a new algorithm that under-approximates the match pairs for a CTP iteratively: first sectioning each process in the CTP for the sequential receives, then distributing the same number of sends that may potentially match the receives in each section from multiple senders to the section, and finally approximating the match pairs for the sends and receives in each section independently by a few simple rules with ranking. The algorithm runs in quadratic complexity in the number of operations. Novel in the work is that the algorithm has the flexibility to generate the match pair set with various size based on the user input. This paper further proves that the precise match pairs for any CTP can be generated with a bounded input. The benchmarks show that the algorithm in this paper drastically reduce the runtime performance of property witnessing as all the properties are witnessed with a small set of match pairs generated by the new algorithm. Experiments also show that the algorithm is able to scale to a program that employs a high degree of message non-determinism and/or a high degree of deep communication.