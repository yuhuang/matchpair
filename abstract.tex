Asynchronous message passing paradigm is commonly used in high performance computing.
Message non-determinism makes the error detection in message passing programs very difficult. The prior work uses an over-approximation of the precise match pair records (each is a pair of a send and a receive that may potentially match in the runtime) to capture all possible message communication in a concurrent trace program (CTP). The SMT encoding with such a set of match pairs is able to detect errors including deadlock, message race, and zero-buffer incompatibility, however, is inefficient because of the exponential ways of match pair resolution.
This paper presents a new algorithm that under-approximates the match pairs iteratively: first matching a section in the CTP by queuing a fixed number of receives from a common process where the size depends on the user input, then distributing the same number of sends that may potentially match the receives from multiple processes to the section, and finally approximating the match pairs for the sends and receives in the section by comparing the ranking. The algorithm runs in quadratic complexity in the number of operations. Novel in the work is that the algorithm has the flexibility to generate different size of match pairs based on the user input. This paper further proves that the precise match pairs for any CTP can be generated with an appropriate input. The benchmarks show that all the errors are efficiently detected with a small set of match pairs generated by the new algorithm.